# UI文件修改被恢复问题排查计划

## 问题分析
经过深入排查，发现以下关键信息：

### 已排除的原因
1. **版本控制系统**：项目中没有.git或.svn目录
2. **构建脚本**：没有.bat或.sh脚本
3. **自动化工具**：没有发现自动化脚本
4. **UIC编译器**：Makefile中UIC调用正常，不会修改.ui文件

### 可能的原因
1. **Qt Creator自动格式化**：
   - WeBot.pro.user中有编辑器配置（AutoIndent、cleanIndentation等）
   - 可能在打开.ui文件时自动应用格式化规则

2. **Qt Designer自动保存**：
   - Qt Designer可能有自动保存或自动恢复功能
   - 可能在文件关闭时恢复原始状态

3. **文件权限或锁定**：
   - 文件可能被其他进程锁定
   - 写权限问题导致修改无法保存

4. **IDE配置差异**：
   - 当前工程和备份工程的IDE配置可能不同
   - Qt Creator版本或设置差异

## 排查和解决方案

### 步骤1：验证文件权限
- 检查mainwindow.ui文件的读写权限
- 确认没有其他进程占用该文件

### 步骤2：使用Qt Designer直接编辑
- 使用Qt Designer（designer.exe）打开.ui文件
- 避免使用文本编辑器直接修改
- 在Designer中保存并验证修改是否保留

### 步骤3：检查Qt Creator设置
- 禁用UI文件的自动格式化
- 检查"自动保存"设置
- 对比当前工程和备份工程的Qt Creator配置

### 步骤4：引入版本控制
- 初始化Git仓库追踪文件变化
- 使用git diff查看文件被修改的内容
- 识别是什么导致了文件被恢复

### 步骤5：清理构建产物
- 删除ui_mainwindow.h
- 重新生成Makefile
- 清理可能的缓存文件

### 步骤6：测试验证
- 在当前工程中进行UI修改
- 重新编译并运行程序
- 验证修改是否生效

## 预期结果
通过以上步骤，能够：
1. 确定UI文件被恢复的根本原因
2. 找到解决方案并永久修复问题
3. 建立版本控制机制防止未来类似问题