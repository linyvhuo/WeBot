# WeBot - 企业微信自动问答工具使用说明

## 1. 软件简介

WeBot 是一个基于 Qt 框架开发的企业微信自动问答工具，主要用于实现企业微信中的自动问答功能。该工具通过图像识别、窗口控制和输入模拟等技术，实现了企业微信的自动化操作。

## 2. 软件功能

- 自动启动企业微信
- 自动进入企业微信工作台
- 自动打开"MindSpark"应用
- 自动发送预设问题
- 自动检测回答完成
- 支持多种问题模式（循环、随机、自动生成）
- 支持自定义识别图标
- 支持多显示器
- 完善的日志系统

## 3. 软件安装

### 3.1 系统要求

- Windows 10/11 操作系统
- 企业微信客户端已安装
- 管理员权限（部分功能需要）

### 3.2 安装步骤

1. 下载 WeBot 软件包
2. 解压到任意目录
3. 运行 `WeBot.exe` 可执行文件

## 4. 软件配置

### 4.1 基础设置

1. **企业微信路径**
   - 点击"浏览..."按钮，选择企业微信的安装路径（通常为 `C:\Program Files (x86)\Tencent\WeChatWork\WXWork.exe`）
   - 或者勾选"窗口置顶显示"选项，使企业微信窗口始终置顶

2. **问题设置**
   - 选择问题库文件（默认位于 `Documents\WeBot\Questions.txt`）
   - 选择问题模式：
     - 循环使用预设问题
     - 随机使用预设问题
     - 自动生成问题
   - 设置回答限制提示（如："回答请勿超过十个字"）

3. **自动化设置**
   - 设置循环次数（1-1000次）
   - 设置回答超时时间（5-300秒）
   - 设置轮次间隔时间（1-60秒）
   - 选择出错时是否继续执行
   - 选择超时后是否继续执行

### 4.2 高级设置

1. **图像识别设置**
   - 调整识别阈值（0.1-1.0，建议0.8）
   - 设置最大识别尝试次数（1-10次）
   - 设置页面加载超时时间（1000-10000毫秒）

2. **多显示器设置**
   - 勾选"启用多显示器支持"
   - 设置主显示器索引

### 4.3 图标管理

1. 选择要自定义的图标名称
2. 点击"浏览..."按钮，选择自定义图标文件（支持 PNG、JPG、JPEG、BMP、SVG 格式）
3. 查看图标预览
4. 点击"保存图标配置"按钮保存设置
5. 或点击"重置为默认"按钮恢复默认图标

## 5. 运行自动化问答

### 5.1 准备工作

1. 确保企业微信已安装并登录
2. 确保企业微信中有"MindSpark"应用
3. 确保问题库文件已准备好
4. 确保模板文件已正确配置

### 5.2 启动步骤

1. 点击"💾 保存配置"按钮保存当前配置
2. 点击"🚀 开始自动问答"按钮启动自动化
3. 观察日志输出，了解自动化执行情况
4. 如需停止，点击"⏹️ 停止执行"按钮

### 5.3 自动化流程

1. 检查企业微信是否运行，如未运行则启动
2. 激活企业微信窗口
3. 进入企业微信工作台
4. 打开"MindSpark"应用
5. 循环执行问答流程：
   - 查找输入框
   - 获取问题
   - 输入问题并发送
   - 等待回答完成
   - 等待轮次间隔时间
6. 完成所有问答后，状态变为"已完成"

## 6. 常见问题及解决方案

### 6.1 模板文件加载失败

**问题现象**：
```
无法打开SVG文件: :/templates/workbench.svg
无法打开SVG文件: :/templates/weiweisou.svg
无法打开SVG文件: :/templates/input_box.svg
无法打开SVG文件: :/templates/send_button.svg
图像模板加载失败，无法启动自动化
```

**解决方案**：

1. **检查模板文件位置**
   - 确保 `templates` 目录与 `WeBot.exe` 位于同一目录下
   - 确保 `templates` 目录中包含以下文件：
     - `workbench.svg`
     - `weiweisou.svg`
     - `input_box.svg`
     - `send_button.svg`
     - 以及它们的大、小尺寸变体

2. **检查资源文件配置**
   - 确保 `resources.qrc` 文件中正确配置了模板文件路径
   - 确保 `resources.qrc` 文件与 `WeBot.exe` 位于同一目录下

3. **重新构建项目**
   - 如果您修改了模板文件或资源配置，需要重新构建项目
   - 使用 Qt Creator 打开 `WeBot.pro` 文件
   - 点击"构建"按钮重新构建项目

### 6.2 无法找到企业微信窗口

**问题现象**：
```
无法获取企业微信窗口句柄
企业微信未准备好
```

**解决方案**：

1. 确保企业微信已登录
2. 确保企业微信窗口未最小化到托盘
3. 手动打开企业微信，然后再点击"开始自动问答"
4. 检查企业微信路径配置是否正确

### 6.3 无法找到工作台或MindSpark图标

**问题现象**：
```
未找到工作台图标，尝试点击固定位置
未找到MindSpark图标，尝试搜索应用
```

**解决方案**：

1. 确保企业微信界面处于默认状态，未进行自定义布局
2. 尝试调整企业微信窗口大小，使其完全显示
3. 手动进入工作台，确保"MindSpark"应用可见
4. 使用"图标管理"功能自定义识别图标

### 6.4 回答超时

**问题现象**：
```
等待回答超时
```

**解决方案**：

1. 增加"回答超时"设置（建议30-60秒）
2. 勾选"超时后继续执行"选项
3. 确保网络连接稳定
4. 确保"MindSpark"应用响应正常

## 7. 模板文件自定义

### 7.1 模板文件格式

- 支持 SVG 格式（推荐）
- 支持 PNG、JPG、JPEG、BMP 格式
- 建议尺寸：64x64 像素
- 建议使用简单、清晰的图标

### 7.2 模板文件列表

| 图标名称 | 用途 |
|---------|------|
| workbench.svg | 企业微信工作台图标 |
| weiweisou.svg | "MindSpark"应用图标 |
| input_box.svg | 输入框图标 |
| send_button.svg | 发送按钮图标 |
| search_box.svg | 搜索框图标 |

### 7.3 自定义模板文件

1. 准备自定义图标文件
2. 将文件命名为上述模板文件名称
3. 替换 `templates` 目录中的对应文件
4. 重启软件或重新加载配置

## 8. 问题库管理

### 8.1 问题库格式

WeBot 支持两种格式的问题库文件：

#### 8.1.1 纯文本格式 (.txt)

纯文本文件，每行一个问题，例如：
```
什么是嵌入式系统？
嵌入式系统有哪些应用领域？
MCU和CPU有什么区别？
```

#### 8.1.2 CSV格式 (.csv)

CSV（逗号分隔值）格式，支持更灵活的问题管理，例如：

| 问题 | 优先级 |
|------|--------|
| 什么是嵌入式系统？ | 高 |
| 嵌入式系统有哪些应用领域？ | 中 |
| MCU和CPU有什么区别？ | 低 |

**CSV文件格式要求：**
- 第一行必须是标题行（例如：`问题,优先级`）
- 每行一个问题，字段之间用逗号分隔
- 支持中文和英文
- 支持UTF-8和GBK编码
- 建议使用Excel或Notepad++等工具编辑

**CSV文件模板：**
```csv
问题,优先级
什么是嵌入式系统？,高
嵌入式系统有哪些应用领域？,中
MCU和CPU有什么区别？,低
嵌入式开发常用的语言有哪些？,高
什么是RTOS？,中
嵌入式系统有哪些主要的特点？,中
什么是中断服务程序？,低
嵌入式系统的开发流程是什么？,高
什么是GPIO？,中
I2C和SPI有什么区别？,低
```

### 8.2 默认问题库

默认问题库位于 `Documents\WeBot\Questions.txt`，包含10个默认问题。

### 8.3 自定义问题库

1. **创建自定义问题库文件**
   - 使用纯文本格式：每行一个问题，保存为 `.txt` 文件
   - 使用CSV格式：按照上述模板创建，保存为 `.csv` 文件

2. **使用自定义问题库**
   - 点击"浏览问题库"按钮，选择您创建的问题库文件
   - 对于CSV文件，会弹出预览窗口，显示文件内容
   - 检查预览内容，确保没有乱码和格式错误
   - 点击"确定"按钮确认选择
   - 点击"💾 保存配置"按钮保存设置

3. **预览CSV文件**
   - 当选择CSV文件时，系统会自动弹出预览窗口
   - 预览窗口显示文件的前20行内容
   - 支持UTF-8和GBK编码自动识别
   - 如果预览显示乱码，建议将文件转换为UTF-8编码

### 8.4 问题顺序管理

- **循环模式**：按照问题库中的顺序循环发送
- **随机模式**：随机选择问题发送，不考虑顺序
- **自动生成模式**：根据关键词库自动生成问题，不使用问题库文件

### 8.5 最佳实践

1. **使用CSV格式**：对于大量问题，建议使用CSV格式，便于管理和排序
2. **合理设置优先级**：在CSV文件中使用优先级字段，便于后续扩展功能
3. **保持编码统一**：建议使用UTF-8编码，避免跨平台问题
4. **定期备份**：定期备份问题库文件，防止数据丢失
5. **测试问题**：在使用新问题库前，建议先进行测试，确保问题格式正确

## 9. 日志管理

### 9.1 日志查看

- 在"日志监控"标签页中查看实时日志
- 日志包含时间戳、状态变更、操作记录等信息

### 9.2 日志导出

- 点击"📤 导出日志"按钮导出日志
- 日志文件格式为 `.log`

### 9.3 日志清空

- 点击"🗑️ 清空日志"按钮清空当前日志显示

## 10. 配置文件

### 10.1 配置文件位置

- 配置文件位于 `Documents\WeBot\config.ini`
- 问题库位于 `Documents\WeBot\Questions.txt`
- 关键词库位于 `Documents\WeBot\Keywords.txt`

### 10.2 配置文件备份

建议定期备份配置文件和问题库文件，以防止数据丢失。

## 11. 注意事项

1. 使用该工具时，请确保遵守企业微信的使用规范
2. 请勿用于恶意用途
3. 建议在测试环境中先进行测试
4. 定期更新模板文件，以适应企业微信界面变化
5. 如遇到问题，请查看日志信息，了解具体错误原因

## 12. 技术支持

如遇到无法解决的问题，请：
1. 查看日志信息，了解具体错误原因
2. 检查配置是否正确
3. 尝试重新启动软件
4. 尝试重新构建项目
5. 联系开发者获取技术支持

## 13. 版本更新

### 1.0.0
- 初始版本
- 实现基本的自动问答功能
- 支持多种问题模式
- 支持自定义识别图标
- 支持多显示器
- 完善的日志系统

---

祝您使用愉快！

WeBot 开发团队
2025年11月