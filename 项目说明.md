# WeBot 项目说明

## 1. 项目概述

WeBot 是一个基于 Qt 框架开发的企业微信自动化工具，主要用于实现企业微信中的自动问答功能。该工具通过图像识别、窗口控制和输入模拟等技术，实现了企业微信的自动化操作。

## 2. 项目结构

```
WeBot/
├── main.cpp                 # 主程序入口
├── mainwindow.h/cpp         # 主窗口界面
├── automator.h/cpp          # 自动化核心逻辑
├── wechatcontroller.h/cpp   # 企业微信控制
├── imagerecognizer.h/cpp    # 图像识别模块
├── inputsimulator.h/cpp     # 输入模拟模块
├── questionmanager.h/cpp    # 问题管理模块
├── configmanager.h/cpp      # 配置管理模块
├── logger.h/cpp             # 日志系统
└── ...                      # 其他资源文件
```

## 3. 核心功能模块

### 3.1 自动化核心 (Automator)

- 管理自动化流程的状态和生命周期
- 协调各个子模块的工作
- 处理自动化任务的开始、运行和结束

### 3.2 企业微信控制 (WeChatController)

- 企业微信的启动、激活和关闭
- 窗口句柄管理和位置控制
- 多显示器支持

### 3.3 图像识别 (ImageRecognizer)

- 屏幕和窗口截图
- 模板匹配和图像查找
- 多尺度和自适应阈值匹配

### 3.4 输入模拟 (InputSimulator)

- 键盘和鼠标输入模拟
- 实现自动化操作

### 3.5 问题管理 (QuestionManager)

- 预设问题管理，支持纯文本和CSV格式
- 问题生成和智能推荐
- 关键词库管理
- CSV问题库预览和编码自动识别
- 支持问题优先级管理

### 3.6 配置管理 (ConfigManager)

- 配置文件的加载和保存
- 默认配置的创建
- 问题库和关键词库的管理

### 3.7 日志系统 (Logger)

- 多级别日志记录
- 日志文件管理和旋转
- 日志统计和过滤

## 4. 项目特点

1. **模块化设计**：各个功能模块独立，便于维护和扩展
2. **多显示器支持**：可以在多个显示器上运行
3. **智能问题生成**：支持多种问题生成模式
4. **图像识别优化**：支持多尺度和自适应阈值匹配
5. **完善的日志系统**：便于调试和问题追踪
6. **配置持久化**：配置自动保存和加载

## 8. 运行环境

- Windows 10/11
